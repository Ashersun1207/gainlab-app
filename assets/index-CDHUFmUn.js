const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Dth5tUFx.js","assets/mosaic-86Umg_jF.js","assets/echarts-DW2iXprX.js"])))=>i.map(i=>d[i]);
import{b as m,_ as p}from"./index-ke4T4Ffm.js";import{j as l}from"./mosaic-86Umg_jF.js";import{a}from"./echarts-DW2iXprX.js";const h=a.lazy(()=>p(()=>import("./index-Dth5tUFx.js"),__vite__mapDeps([0,1,2])).then(e=>({default:e.EChartsWidget})));function y(e,r){const n=Object.keys(r).slice(0,10),t=n.map(s=>r[s]);return{backgroundColor:"#0d0d20",title:{text:`${e} 基本面`,textStyle:{color:"#ccc",fontSize:12},left:10,top:8},tooltip:{trigger:"axis",backgroundColor:"#1a1a2e",borderColor:"#2a2a4a",textStyle:{color:"#e0e0e0",fontSize:11}},grid:{left:60,right:20,top:45,bottom:40},xAxis:{type:"category",data:n,axisLabel:{color:"#888",fontSize:9,rotate:30},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{color:"#888"},splitLine:{lineStyle:{color:"#1e1e3a"}}},series:[{type:"bar",data:t.map(s=>({value:s,itemStyle:{color:s>=0?"#22c55e":"#ef4444"}})),barWidth:"60%"}]}}function g(e){const r={},n=["pe","pb","ps","roe","roa","grossMargin","netMargin","debtToEquity","currentRatio","dividendYield","eps","revenue","netIncome","marketCap"];for(const t of n)t in e&&typeof e[t]=="number"&&(r[t]=e[t]);if(Object.keys(r).length===0)for(const[t,s]of Object.entries(e))typeof s=="number"&&!t.startsWith("_")&&(r[t]=s);return r}function k({symbol:e}){const[r,n]=a.useState(null),[t,s]=a.useState(!1),[f,d]=a.useState(null),i=a.useRef(!1),x=a.useCallback(async()=>{if(e){i.current=!1,s(!0),d(null);try{const c=await m(e);i.current||n(c)}catch(c){i.current||d(c instanceof Error?c.message:"Failed to fetch fundamentals")}finally{i.current||s(!1)}}},[e]);a.useEffect(()=>(x(),()=>{i.current=!0}),[x]);const o=a.useMemo(()=>r?g(r):null,[r]),u=a.useMemo(()=>o&&Object.keys(o).length>0?y(e,o):null,[e,o]);return f?l.jsx("div",{className:"w-full h-full flex items-center justify-center text-[#ef4444] text-sm",children:f}):e?!u&&!t?l.jsx("div",{className:"w-full h-full flex items-center justify-center text-[#6666aa] text-sm",children:"暂无基本面数据"}):l.jsxs("div",{className:"w-full h-full relative",children:[t&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#0d0d20]/80 z-10",children:l.jsx("span",{className:"text-[#8888aa] text-sm",children:"加载中..."})}),u&&l.jsx(a.Suspense,{fallback:l.jsx("div",{className:"w-full h-full bg-[#0d0d20]"}),children:l.jsx(h,{option:u,style:{height:"100%"}})})]}):l.jsx("div",{className:"w-full h-full flex items-center justify-center text-[#6666aa] text-sm",children:"选择资产查看基本面数据"})}export{k as FundamentalsWidget};
