const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CGvyI1KM.js","assets/mosaic-86Umg_jF.js","assets/echarts-DW2iXprX.js"])))=>i.map(i=>d[i]);
import{a as p,_ as h}from"./index-YuRF0Sw1.js";import{j as s}from"./mosaic-86Umg_jF.js";import{a}from"./echarts-DW2iXprX.js";const y=a.lazy(()=>h(()=>import("./index-CGvyI1KM.js"),__vite__mapDeps([0,1,2])).then(e=>({default:e.EChartsWidget})));function g(e,r,n){const t=Object.keys(r).slice(0,10),l=t.map(i=>r[i]);return{backgroundColor:"#0d0d20",...n?{}:{title:{text:`${e} 基本面`,textStyle:{color:"#ccc",fontSize:12},left:10,top:8}},tooltip:{trigger:"axis",backgroundColor:"#1a1a2e",borderColor:"#2a2a4a",textStyle:{color:"#e0e0e0",fontSize:11}},grid:{left:60,right:20,top:n?10:45,bottom:40},xAxis:{type:"category",data:t,axisLabel:{color:"#888",fontSize:9,rotate:30},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{color:"#888"},splitLine:{lineStyle:{color:"#1e1e3a"}}},series:[{type:"bar",data:l.map(i=>({value:i,itemStyle:{color:i>=0?"#22c55e":"#ef4444"}})),barWidth:"60%"}]}}function j(e){const r={},n=["pe","pb","ps","roe","roa","grossMargin","netMargin","debtToEquity","currentRatio","dividendYield","eps","revenue","netIncome","marketCap"];for(const t of n)t in e&&typeof e[t]=="number"&&(r[t]=e[t]);if(Object.keys(r).length===0)for(const[t,l]of Object.entries(e))typeof l=="number"&&!t.startsWith("_")&&(r[t]=l);return r}function S({symbol:e,headless:r}){const[n,t]=a.useState(null),[l,i]=a.useState(!1),[d,x]=a.useState(null),o=a.useRef(!1),m=a.useCallback(async()=>{if(e){o.current=!1,i(!0),x(null);try{const u=await p(e);o.current||t(u)}catch(u){o.current||x(u instanceof Error?u.message:"Failed to fetch fundamentals")}finally{o.current||i(!1)}}},[e]);a.useEffect(()=>(m(),()=>{o.current=!0}),[m]);const c=a.useMemo(()=>n?j(n):null,[n]),f=a.useMemo(()=>c&&Object.keys(c).length>0?g(e,c,r):null,[e,c,r]);return d?s.jsx("div",{className:"w-full h-full flex items-center justify-center text-[#ef4444] text-sm",children:d}):e?!f&&!l?s.jsx("div",{className:"w-full h-full flex items-center justify-center text-[#6666aa] text-sm",children:"暂无基本面数据"}):s.jsxs("div",{className:"w-full h-full relative",children:[l&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#0d0d20]/80 z-10",children:s.jsx("span",{className:"text-[#8888aa] text-sm",children:"加载中..."})}),f&&s.jsx(a.Suspense,{fallback:s.jsx("div",{className:"w-full h-full bg-[#0d0d20]"}),children:s.jsx(y,{option:f,style:{height:"100%"}})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-[#6666aa] text-sm",children:"选择资产查看基本面数据"})}export{S as FundamentalsWidget};
